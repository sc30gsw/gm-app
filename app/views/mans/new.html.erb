<header class="header">
  <%= render 'shared/header' %>
</header>
<%= form_with(model: @man, url: mans_path, method: :post, local: true) do |f| %>
  <div class="new-main">
    <div class="new-content">
      <div class="error-flash-message">
        <%= render 'shared/error_messages', model: @man %>
      </div>
      <div class="new-caption-area">
        <div class="new-first-box">
          <%= f.text_field :name, placeholder: '偉人の名前・場所など', maxlength: 40, class: "new-capstion-input" %>
        </div>
        <div class="new-second-box">
          <div class="second-box-first">
            <ul class="new-category-lists">
              <li>
                <%= f.radio_button :category_id, '10', class: 'category-radio-btn' %>
                <label>安土桃山</label>
              </li>
              <li>
                <%= f.radio_button :category_id, '11', class: 'category-radio-btn' %>
                <label>江戸</label>
              </li>
              <li>
                <%= f.radio_button :category_id, '13', class: 'category-radio-btn' %>
                <label>幕末</label>
              </li>
              <li>
                <%= f.radio_button :category_id, '16', class: 'category-radio-btn' %>
                <label>ヨーロッパ</label>
              </li>
              <li>
                <%= f.radio_button :category_id, '17', class: 'category-radio-btn' %>
                <label>北アメリカ</label>
              </li>
              <li>
                <%= f.radio_button :category_id, '19', class: 'category-radio-btn' %>
                <label>中国</label>
              </li>
            </ul>
          </div>
          <div class="second-box-second">
            <div>カテゴリー一覧</div>
            <%= f.collection_select(:category_id, Category.all, :id, :name, {}, {class: 'category-select'}) %>
          </div>
          <div class="second-box-third">
            <input type="text" class="nwe-capiton-input" placeholder="#ハッシュタグ">
          </div>
        </div>
        <div class="new-third-box">
          <span>画像</span>
          <%= f.file_field :image %>
        </div>
        <div class="new-four-box">
          <%= f.label :address, "検索" %>
          <%= f.text_field :address, id: :address %>
          <input type="button" value="検索" onclick="codeAddress()">
          <div class="form">
            <%= f.label :latitude %>
            <%= f.hidden_field :latitude,:value =>"緯度", id: :latitude %>
            <%= f.label :longitude %>
            <%= f.hidden_field :longitude,:value =>"経度", id: :longitude %>
          </div>
          <div id='map'></div>
          <style>
            #map {
              height: 600px;
              width: 600px;
            }
          </style>
          <script>
            let map
            let geocoder
            let marker

            function initMap() {
              geocoder = new google.maps.Geocoder()
              // デフォルト位置は東京
              map = new google.maps.Map(document.getElementById('map'), {
                center: {
                  lat: 35.681,
                  lng: 139.767
                },
                zoom: 12,
              }); 
            }
            function codeAddress() {
              let inputAddress = document.getElementById('address').value;
            geocoder.geocode({
                'address': inputAddress

              }, function (results, status) {
                if (status == 'OK') {
                  map.setCenter(results[0].geometry.location);

                  var marker = new google.maps.Marker({
                    map: map,
                    position: results[0].geometry.location
                  });
                }
                else {
                  alert('Geocode was not successful for the following reason: ' + status);
                }
              });
            }
          </script>
          <script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_API'] %>&callback=initMap" async defer>
          </script>
        </div>
      </div>
      <div class="new-input-area">
      </div>
    </div>
  </div>
<% end %>